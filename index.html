<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>

<style> 
    circle {stroke: black;} 
    .tooltip {
        position: fixed;
        display: inline-block;
        border-color: black transparent transparent transparent;
    }
</style>
<body onload="init()">
<div id="tooltip_div"></div>    
<p>
    <svg id="the_chart_svg" width="700" height="600" style="display: block;margin: auto"></svg>
    <svg id="the_legend_svg" width="700" height="100" style="display: block;margin: auto"></svg>
</p>
<p id="the_text"> 
    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Id cursus metus aliquam eleifend mi in. Id cursus metus aliquam eleifend. Sagittis eu volutpat odio facilisis mauris sit amet. Facilisi cras fermentum odio eu feugiat pretium nibh ipsum. Tellus rutrum tellus pellentesque eu tincidunt tortor. Turpis egestas maecenas pharetra convallis posuere morbi leo urna. Fusce id velit ut tortor pretium viverra suspendisse potenti nullam. Sed elementum tempus egestas sed sed risus pretium. Vitae ultricies leo integer malesuada nunc vel risus. Tristique senectus et netus et. Purus gravida quis blandit turpis cursus in. Nullam non nisi est sit amet facilisis magna etiam. Mauris in aliquam sem fringilla ut morbi tincidunt. Nam aliquam sem et tortor consequat id porta.
    
    Laoreet id donec ultrices tincidunt arcu non. Venenatis urna cursus eget nunc scelerisque viverra mauris in aliquam. Eget egestas purus viverra accumsan in nisl nisi scelerisque. Amet purus gravida quis blandit turpis cursus in hac. Adipiscing elit duis tristique sollicitudin. Id velit ut tortor pretium viverra suspendisse potenti. Fermentum posuere urna nec tincidunt praesent semper feugiat nibh. Libero enim sed faucibus turpis in eu mi bibendum. Scelerisque purus semper eget duis. Posuere lorem ipsum dolor sit amet consectetur. Amet mauris commodo quis imperdiet. Dictum fusce ut placerat orci nulla pellentesque dignissim enim. Ac auctor augue mauris augue neque gravida in. Faucibus et molestie ac feugiat sed lectus vestibulum mattis ullamcorper. Diam phasellus vestibulum lorem sed risus ultricies tristique. Ultrices vitae auctor eu augue ut lectus arcu bibendum at.
    
    Libero justo laoreet sit amet cursus sit. Libero id faucibus nisl tincidunt eget nullam non nisi. Laoreet non curabitur gravida arcu. In massa tempor nec feugiat nisl pretium fusce. Vitae congue mauris rhoncus aenean vel elit scelerisque mauris. Enim praesent elementum facilisis leo vel fringilla est. Pretium lectus quam id leo in vitae. In nibh mauris cursus mattis molestie. Posuere morbi leo urna molestie. Praesent elementum facilisis leo vel fringilla. Lacus sed viverra tellus in hac habitasse platea dictumst. Quisque id diam vel quam elementum pulvinar. Tincidunt praesent semper feugiat nibh sed pulvinar proin. Sed vulputate mi sit amet mauris. In est ante in nibh mauris.
    
    Quam id leo in vitae turpis. At tellus at urna condimentum mattis pellentesque id nibh tortor. Auctor neque vitae tempus quam pellentesque nec nam aliquam sem. Platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper. Urna molestie at elementum eu. Egestas maecenas pharetra convallis posuere morbi leo urna molestie at. Quis imperdiet massa tincidunt nunc pulvinar sapien et. Aliquet porttitor lacus luctus accumsan tortor posuere ac ut. Ultricies mi eget mauris pharetra et ultrices. Sem viverra aliquet eget sit amet tellus cras. Vitae proin sagittis nisl rhoncus mattis rhoncus urna. Placerat orci nulla pellentesque dignissim. In nisl nisi scelerisque eu. Feugiat nibh sed pulvinar proin gravida hendrerit. Elementum facilisis leo vel fringilla est ullamcorper eget. Aliquam vestibulum morbi blandit cursus risus at. Viverra nam libero justo laoreet sit. Suspendisse in est ante in nibh mauris cursus mattis. Pretium vulputate sapien nec sagittis aliquam malesuada bibendum arcu vitae. Mauris in aliquam sem fringilla ut morbi tincidunt augue interdum.
    
    Aliquam eleifend mi in nulla posuere sollicitudin. Tincidunt augue interdum velit euismod in. Mauris pharetra et ultrices neque. A cras semper auctor neque vitae. Sed egestas egestas fringilla phasellus faucibus scelerisque eleifend donec pretium. Malesuada fames ac turpis egestas sed. Lectus sit amet est placerat. Viverra ipsum nunc aliquet bibendum enim facilisis gravida neque convallis. Iaculis at erat pellentesque adipiscing commodo elit at imperdiet. In est ante in nibh mauris. Consectetur adipiscing elit ut aliquam purus sit. Orci phasellus egestas tellus rutrum tellus pellentesque eu tincidunt. Elit duis tristique sollicitudin nibh. Risus pretium quam vulputate dignissim suspendisse in est ante in. Semper risus in hendrerit gravida rutrum quisque non tellus. At varius vel pharetra vel turpis nunc. Montes nascetur ridiculus mus mauris vitae ultricies leo integer malesuada.
    
    Lorem ipsum dolor sit amet. Maecenas ultricies mi eget mauris pharetra et. Ipsum faucibus vitae aliquet nec. Cras ornare arcu dui vivamus arcu felis. Sed egestas egestas fringilla phasellus faucibus scelerisque eleifend donec pretium. Imperdiet massa tincidunt nunc pulvinar sapien et ligula. Imperdiet proin fermentum leo vel orci. Morbi leo urna molestie at elementum. Quam quisque id diam vel quam elementum pulvinar. Nisi est sit amet facilisis magna etiam tempor orci eu. Sed felis eget velit aliquet sagittis id consectetur purus ut.
    
    Senectus et netus et malesuada fames ac turpis egestas integer. Viverra accumsan in nisl nisi scelerisque. Volutpat ac tincidunt vitae semper quis. Id velit ut tortor pretium viverra suspendisse. Volutpat blandit aliquam etiam erat. Mi in nulla posuere sollicitudin aliquam ultrices sagittis orci. Sapien pellentesque habitant morbi tristique senectus et netus et. Felis donec et odio pellentesque. Duis tristique sollicitudin nibh sit. Mus mauris vitae ultricies leo integer malesuada nunc. Lacus suspendisse faucibus interdum posuere lorem ipsum dolor sit amet.
    
    Pretium quam vulputate dignissim suspendisse. Rutrum quisque non tellus orci ac auctor augue. Id faucibus nisl tincidunt eget nullam non nisi est. Fusce id velit ut tortor. Ut sem nulla pharetra diam sit amet. Lorem ipsum dolor sit amet consectetur. Morbi quis commodo odio aenean sed. Imperdiet sed euismod nisi porta lorem mollis. Enim tortor at auctor urna. Adipiscing elit duis tristique sollicitudin nibh sit amet commodo. Laoreet sit amet cursus sit amet dictum sit.
    
    Sed velit dignissim sodales ut eu. Ac tortor vitae purus faucibus ornare suspendisse sed. Massa tincidunt dui ut ornare lectus. Sit amet dictum sit amet justo donec enim diam. Viverra ipsum nunc aliquet bibendum. Pharetra massa massa ultricies mi quis hendrerit dolor magna. Blandit turpis cursus in hac habitasse platea dictumst quisque sagittis. Condimentum mattis pellentesque id nibh. Turpis egestas maecenas pharetra convallis posuere. Quis risus sed vulputate odio ut enim blandit volutpat. Sit amet nisl suscipit adipiscing bibendum. Nunc vel risus commodo viverra. Commodo viverra maecenas accumsan lacus vel. At tellus at urna condimentum. Pellentesque massa placerat duis ultricies. Viverra accumsan in nisl nisi scelerisque. In fermentum posuere urna nec tincidunt praesent semper.
    
    Donec adipiscing tristique risus nec feugiat in fermentum posuere. Ut etiam sit amet nisl purus. At tellus at urna condimentum mattis pellentesque id. Tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam malesuada bibendum arcu vitae elementum curabitur vitae nunc. Vitae congue eu consequat ac. Lacus sed turpis tincidunt id aliquet risus feugiat. Praesent elementum facilisis leo vel fringilla est ullamcorper. Ac placerat vestibulum lectus mauris. Mauris pellentesque pulvinar pellentesque habitant morbi tristique senectus et. Ultricies lacus sed turpis tincidunt id aliquet risus. Et netus et malesuada fames ac. Sem et tortor consequat id porta nibh venenatis cras.    
</p>
<script>
    const lowThreshold = 50;
    const mediumThreshold = 80;
    const lowTag = "Low";
    const mediumTag = "Medium";
    const highTag = "High";

    const tagColor = {
        "Low": "red",
        "Medium": "orange",
        "High": "green"
    };
    
    function qualityTag(score) {
        if (score <= lowThreshold) {
            return lowTag;
        } else if (score > lowThreshold && score <= mediumThreshold) {
            return mediumTag;  
        } else {
            return highTag;
        }
    }

    function qualityOverview () {
        d3.csv("overview_quality.csv")
        .then(function(data) {
            var svg = d3.select("#the_chart_svg");
            translateX = 50;
            translateY = 50;
            width = svg.attr("width") - (2 * translateX);
            height = svg.attr("height") - (2 * translateY);

            // x value
            const parseDate = d3.timeParse("%d-%b-%y");

            const x = d3.scaleTime()
                    .domain(d3.extent(data, (date) => parseDate(date.Date)))
                    .range([0,width]);
            const y = d3.scaleLinear()
                    .domain([30,100])
                    .range([height,0]);

            // Add the lines
            var div = d3.select("#tooltip_div")
                .attr('class', 'tooltip')
                .style('opacity', 0);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .datum(data)
                .attr("fill", "none")
                .attr("stroke", "black")
                .attr("stroke-width", 1.5)
                .attr("d", d3.line()
                    .x(function(d) { return x(parseDate(d.Date)); })
                    .y(function(d) { return y(d.TotalQualityScore); })
                );

            // Add the scatter-points
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", function(d) { return x(parseDate(d.Date)); }  )
                .attr("cy", function(d) { return y(d.TotalQualityScore); } )
                .attr("r", 8)
                .style("fill", 
                    function(d) {
                        return tagColor[qualityTag(d.TotalQualityScore)];
                    }
                )
                .style('cursor', 'pointer')
                .on('mouseover', 
                    function(d) {
                        div
                            .transition()
                            .duration(200)
                            .style('opacity', 0.9);
                        div
                            .html("<b>Date: " + d.Date + "<br/> Score: " + d.TotalQualityScore + "</b>")
                            .style("left", (d3.event.pageX-15) + "px")
                            .style("top", (d3.event.pageY-55) + "px");
                    }
                )
                .on('mouseout', 
                    () => {
                        div
                            .transition()
                            .duration(500)
                            .style('opacity', 0);
                    }
                )
                .on("click", function(d) {
                    clearChart();
                    qualityWeekly(d.Date);
                });

            // Add y-axis
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(d3.axisLeft(y));

            // Add x-axis
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+(height+translateY)+")")
                .call(d3.axisBottom(x));

            // Add X axis label
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("text")
                .attr("text-anchor", "end")
                .attr("x", (width / 2) + 80)
                .attr("y", height + 40)
                .text("Evaluation Date");
            // Y axis label
            svg.append("text")
                .attr("text-anchor", "end")
                .attr("transform", "rotate(-90)")
                .attr("y", 15)
                .attr("x", -height/2)
                .text("Quality Score")

            // Add low threshold
            var path = d3.path();
            path.moveTo(0, y(lowThreshold));
            path.lineTo(width, y(lowThreshold));

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .attr("d", path)
                .attr("stroke", "red");

            // Add medium threshold
            path = d3.path();
            path.moveTo(0, y(mediumThreshold));
            path.lineTo(width, y(mediumThreshold));

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .attr("d", path)
                .attr("stroke", "orange");

            // Add low quality threshold annotation
            var annotations = [
                {
                    note: {
                        label: "Low Quality Threshold Line",
                        align: "middle",
                        wrap: 100,
                        padding: 5
                    },
                    connector: {
                        end: "arrow",
                        type: "line"
                    },    
                    type: d3.annotationCalloutCircle,
                    subject: {
                        radius: 10, 
                        radiusPadding: 0
                    },
                    x: width-20,
                    y: y(lowThreshold),
                    dx: -10,
                    dy: 40,
                    color: ["red"]
                }
            ];

            var makeAnnotations = d3.annotation().annotations(annotations);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(makeAnnotations);


            // Add medium quality threshold annotation
            annotations = [
                {
                    note: {
                        label: "Medium Quality Threshold Line",
                        align: "middle",
                        wrap: 100,
                        padding: 5
                    },
                    connector: {
                        end: "arrow",
                        type: "line"
                    },
                    type: d3.annotationCalloutCircle,
                    subject: {
                        radius: 10, 
                        radiusPadding: 0
                    },
                    x: width-20,
                    y: y(mediumThreshold),
                    dx: -10,
                    dy: 40,
                    color: ["orange"]
                }
            ];

            makeAnnotations = d3.annotation().annotations(annotations);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(makeAnnotations);

            // Add chart title
            svg.append("text")
                .attr("x", (width / 2) + 40)             
                .attr("y", 20)
                .attr("text-anchor", "middle")  
                .style("font-size", "20px") 
                .style("text-decoration", "underline")  
                .text("Wellbore Data-Quality Score Overview");

            // Add legend
            var svg = d3.select("#the_legend_svg");

            svg.append("text").attr("x",5).attr("y",20).text("Legend: ").style("font-size", "16px").style("text-decoration", "underline");
            svg.append("circle").attr("cx",10).attr("cy",40).attr("r", 6).style("fill", "green");
            svg.append("circle").attr("cx",10).attr("cy",60).attr("r", 6).style("fill", "orange");
            svg.append("circle").attr("cx",10).attr("cy",80).attr("r", 6).style("fill", "red");
            svg.append("text").attr("x",20).attr("y",40).text("High Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
            svg.append("text").attr("x",20).attr("y",60).text("Medium Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
            svg.append("text").attr("x",20).attr("y",80).text("Low Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
        })
        .catch(function(error){
            // handle error
        })
    }

    function qualityWeekly (Date) {
        d3.csv("wellbore_quality.csv")
        .then(function(data) {
            data = data.filter(function (el) {
                return (el.Date == Date);
            });

            var svg = d3.select("#the_chart_svg");
            translateX = 50;
            translateY = 50;
            width = svg.attr("width") - (2 * translateX);
            height = svg.attr("height") - (2 * translateY);

            // x value
            const parseDate = d3.timeParse("%d-%b-%y");

            var wellbores = [];
            for(var i=0; i<data.length; i++){
                wellbores.push(data[i].Wellbore);
            }

            const x = d3.scaleBand()
                    .domain(wellbores)
                    .range([0,width]);
            const y = d3.scaleLinear()
                    .domain([30,100])
                    .range([height,0]);

            // Add the scatter-points   
            const bar_width = 100;
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .selectAll("rect")
                .data(data)
                .enter()
                .append("rect")
                .style("fill", 
                    function(d) {
                        return tagColor[qualityTag(d.TotalQualityScore)];
                    }
                )
                .attr("x", function(d,i) {return x(d.Wellbore) + 100;})
                .attr("y", function(d,i) {return y(d.TotalQualityScore);})
                .attr("width", bar_width)
                .attr("height", function(d,i) {return height-y(d.TotalQualityScore);});

            // Add y-axis
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(d3.axisLeft(y));

            // Add x-axis
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+(height+translateY)+")")
                .call(d3.axisBottom(x));

            // Add X axis label
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("text")
                .attr("text-anchor", "end")
                .attr("x", (width / 2) + 80)
                .attr("y", height + 40)
                .text("Evaluation Date");
            // Y axis label
            svg.append("text")
                .attr("text-anchor", "end")
                .attr("transform", "rotate(-90)")
                .attr("y", 15)
                .attr("x", -height/2)
                .text("Quality Score")

            // Add low threshold
            var path = d3.path();
            path.moveTo(0, y(lowThreshold));
            path.lineTo(width, y(lowThreshold));

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .attr("d", path)
                .attr("stroke", "red");

            // Add medium threshold
            path = d3.path();
            path.moveTo(0, y(mediumThreshold));
            path.lineTo(width, y(mediumThreshold));

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .attr("d", path)
                .attr("stroke", "orange");

            // Add low quality threshold annotation
            var annotations = [
                {
                    note: {
                        label: "Low Quality Threshold Line",
                        align: "middle",
                        wrap: 100,
                        padding: 5
                    },
                    connector: {
                        end: "arrow",
                        type: "line"
                    },    
                    type: d3.annotationCalloutCircle,
                    subject: {
                        radius: 10, 
                        radiusPadding: 0
                    },
                    x: width-20,
                    y: y(lowThreshold),
                    dx: -10,
                    dy: 40,
                    color: ["red"]
                }
            ];

            var makeAnnotations = d3.annotation().annotations(annotations);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(makeAnnotations);


            // Add medium quality threshold annotation
            annotations = [
                {
                    note: {
                        label: "Medium Quality Threshold Line",
                        align: "middle",
                        wrap: 100,
                        padding: 5
                    },
                    connector: {
                        end: "arrow",
                        type: "line"
                    },
                    type: d3.annotationCalloutCircle,
                    subject: {
                        radius: 10, 
                        radiusPadding: 0
                    },
                    x: width-20,
                    y: y(mediumThreshold),
                    dx: -10,
                    dy: 40,
                    color: ["orange"]
                }
            ];

            makeAnnotations = d3.annotation().annotations(annotations);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(makeAnnotations);

            // Add chart title
            svg.append("text")
                .attr("x", (width / 2) + 40)             
                .attr("y", 20)
                .attr("text-anchor", "middle")  
                .style("font-size", "20px") 
                .style("text-decoration", "underline")  
                .text("Wellbore Data-Quality Score Weekly");

            // Add legend
            var svg = d3.select("#the_legend_svg");

            svg.append("text").attr("x",5).attr("y",20).text("Legend: ").style("font-size", "16px").style("text-decoration", "underline");
            svg.append("circle").attr("cx",10).attr("cy",40).attr("r", 6).style("fill", "green");
            svg.append("circle").attr("cx",10).attr("cy",60).attr("r", 6).style("fill", "orange");
            svg.append("circle").attr("cx",10).attr("cy",80).attr("r", 6).style("fill", "red");
            svg.append("text").attr("x",20).attr("y",40).text("High Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
            svg.append("text").attr("x",20).attr("y",60).text("Medium Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
            svg.append("text").attr("x",20).attr("y",80).text("Low Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
        })
        .catch(function(error){
            // handle error
        })
    }    

    function qualityWellbore () {
        d3.csv("overview_quality.csv")
        .then(function(data) {
            var svg = d3.select("#the_chart_svg");
            translateX = 50;
            translateY = 50;
            width = svg.attr("width") - (2 * translateX);
            height = svg.attr("height") - (2 * translateY);

            // x value
            const parseDate = d3.timeParse("%d-%b-%y");

            const x = d3.scaleTime()
                    .domain(d3.extent(data, (date) => parseDate(date.Date)))
                    .range([0,width]);
            const y = d3.scaleLinear()
                    .domain([30,100])
                    .range([height,0]);

            // Add the lines
            var div = d3.select("#tooltip_div")
                .attr('class', 'tooltip')
                .style('opacity', 0);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .datum(data)
                .attr("fill", "none")
                .attr("stroke", "black")
                .attr("stroke-width", 1.5)
                .attr("d", d3.line()
                    .x(function(d) { return x(parseDate(d.Date)); })
                    .y(function(d) { return y(d.TotalQualityScore); })
                );

            // Add the scatter-points
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", function(d) { return x(parseDate(d.Date)); }  )
                .attr("cy", function(d) { return y(d.TotalQualityScore); } )
                .attr("r", 8)
                .style("fill", 
                    function(d) {
                        return tagColor[qualityTag(d.TotalQualityScore)];
                    }
                )
                .style('cursor', 'pointer')
                .on('mouseover', 
                    function(d) {
                        div
                            .transition()
                            .duration(200)
                            .style('opacity', 0.9);
                        div
                            .html("<b>Date: " + d.Date + "<br/> Score: " + d.TotalQualityScore + "</b>")
                            .style("left", (d3.event.pageX-15) + "px")
                            .style("top", (d3.event.pageY-55) + "px");
                    }
                )
                .on('mouseout', 
                    () => {
                        div
                            .transition()
                            .duration(500)
                            .style('opacity', 0);
                    }
                )
                .on("click", function(d) {
                    clearChart();
                });

            // Add y-axis
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(d3.axisLeft(y));

            // Add x-axis
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+(height+translateY)+")")
                .call(d3.axisBottom(x));

            // Add X axis label
            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("text")
                .attr("text-anchor", "end")
                .attr("x", (width / 2) + 80)
                .attr("y", height + 40)
                .text("Evaluation Date");
            // Y axis label
            svg.append("text")
                .attr("text-anchor", "end")
                .attr("transform", "rotate(-90)")
                .attr("y", 15)
                .attr("x", -height/2)
                .text("Quality Score")

            // Add low threshold
            var path = d3.path();
            path.moveTo(0, y(lowThreshold));
            path.lineTo(width, y(lowThreshold));

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .attr("d", path)
                .attr("stroke", "red");

            // Add medium threshold
            path = d3.path();
            path.moveTo(0, y(mediumThreshold));
            path.lineTo(width, y(mediumThreshold));

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .append("path")
                .attr("d", path)
                .attr("stroke", "orange");

            // Add low quality threshold annotation
            var annotations = [
                {
                    note: {
                        label: "Low Quality Threshold Line",
                        align: "middle",
                        wrap: 100,
                        padding: 5
                    },
                    connector: {
                        end: "arrow",
                        type: "line"
                    },    
                    type: d3.annotationCalloutCircle,
                    subject: {
                        radius: 10, 
                        radiusPadding: 0
                    },
                    x: width-20,
                    y: y(lowThreshold),
                    dx: -10,
                    dy: 40,
                    color: ["red"]
                }
            ];

            var makeAnnotations = d3.annotation().annotations(annotations);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(makeAnnotations);


            // Add medium quality threshold annotation
            annotations = [
                {
                    note: {
                        label: "Medium Quality Threshold Line",
                        align: "middle",
                        wrap: 100,
                        padding: 5
                    },
                    connector: {
                        end: "arrow",
                        type: "line"
                    },
                    type: d3.annotationCalloutCircle,
                    subject: {
                        radius: 10, 
                        radiusPadding: 0
                    },
                    x: width-20,
                    y: y(mediumThreshold),
                    dx: -10,
                    dy: 40,
                    color: ["orange"]
                }
            ];

            makeAnnotations = d3.annotation().annotations(annotations);

            svg
                .append("g")
                .attr("transform", "translate("+translateX+","+translateY+")")
                .call(makeAnnotations);

            // Add chart title
            svg.append("text")
                .attr("x", (width / 2) + 40)             
                .attr("y", 20)
                .attr("text-anchor", "middle")  
                .style("font-size", "20px") 
                .style("text-decoration", "underline")  
                .text("Wellbore Data-Quality Score by Dimension");

            // Add legend
            var svg = d3.select("#the_legend_svg");

            svg.append("text").attr("x",5).attr("y",20).text("Legend: ").style("font-size", "16px").style("text-decoration", "underline");
            svg.append("circle").attr("cx",10).attr("cy",40).attr("r", 6).style("fill", "green");
            svg.append("circle").attr("cx",10).attr("cy",60).attr("r", 6).style("fill", "orange");
            svg.append("circle").attr("cx",10).attr("cy",80).attr("r", 6).style("fill", "red");
            svg.append("text").attr("x",20).attr("y",40).text("High Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
            svg.append("text").attr("x",20).attr("y",60).text("Medium Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
            svg.append("text").attr("x",20).attr("y",80).text("Low Quality Data").style("font-size", "14px").attr("alignment-baseline","middle");
        })
        .catch(function(error){
            // handle error
        })
    }    

    function clearChart() {
        d3.select("#the_chart_svg").selectAll("*").remove();
        d3.select("#the_legend_svg").selectAll("*").remove();
        d3.select("#tooltip_div").selectAll("*").remove();
        d3.select("body").style('cursor', 'default');
    }

    async function init() {
        qualityOverview();
    }
</script>
</body>
</html>